# PiGuard Configuration
# https://github.com/Fullex26/piguard

# ── Notification channels (configure at least one) ──
notifications:
  telegram:
    enabled: false
    bot_token: "${PIGUARD_TELEGRAM_TOKEN}"
    chat_id: "${PIGUARD_TELEGRAM_CHAT_ID}"
    interactive: true  # Enable /commands in Telegram

  ntfy:
    enabled: false
    topic: "piguard-alerts"
    server: "https://ntfy.sh"
    token: ""

  discord:
    enabled: false
    webhook_url: "${PIGUARD_DISCORD_WEBHOOK}"

  webhook:
    enabled: false
    url: ""
    method: "POST"

# ── Port monitoring ──
ports:
  enabled: true
  ignore:
    - "127.0.0.1:*"
    - "::1:*"
  known: []
  cooldown: "15m"

# ── Firewall monitoring ──
firewall:
  enabled: true
  chains:
    - table: "filter"
      chain: "INPUT"
      expect_policy: "DROP"
    - table: "filter"
      chain: "DOCKER-USER"
      expect_rule: "DROP.*0.0.0.0/0"
  check_interval: "60s"

# ── System health ──
system:
  disk_threshold: 80
  memory_threshold: 90
  temperature_threshold: 75

# ── Alert behaviour ──
alerts:
  min_severity: "warning"
  daily_summary: "08:00"
  quiet_hours:
    start: "23:00"
    end: "07:00"

# ── Baseline ──
baseline:
  mode: "enforcing"
  learning_duration: "7d"

# ── Docker ──
docker:
  enabled: true
  poll_interval: "10s"
  # Set to true to alert when containers stop gracefully (can be noisy)
  alert_on_stop: false

# ── File integrity monitoring ──
file_integrity:
  enabled: true
  cooldown: "5m"
  paths:
    - path: "/etc/passwd"
      description: "User accounts"
      severity: "critical"
    - path: "/etc/shadow"
      description: "Password hashes"
      severity: "critical"
    - path: "/etc/sudoers"
      description: "Sudo rules"
      severity: "critical"
    - path: "/etc/ssh/sshd_config"
      description: "SSH daemon config"
      severity: "critical"
    - path: "/etc/hosts"
      description: "Host resolution"
      severity: "warning"
    - path: "/etc/crontab"
      description: "System cron"
      severity: "warning"
    - path: "/etc/cron.d"
      description: "Cron job directory"
      severity: "warning"

# ── Security tool log monitoring (ClamAV / rkhunter) ──
security_tools:
  enabled: false
  clamav_log: "/var/log/clamav/clamav.log"
  rkhunter_log: "/var/log/rkhunter.log"
  poll_interval: "30s"
